Total number of parameters: 302400
{'bsz': 600, 'd_model': 64, 'coord_dim': 2, 'nb_layers': 3, 'mlp_cls': 'gatedmlp', 'city_count': 10, 'fourier_scale': None, 'start': 2, 'nb_epochs': 2000, 'nb_batch_per_epoch': 10, 'test_size': 2000, 'save_loc': 'checkpoints/mamba2/mamba1', 'checkpoint': None, 'recycle_data': 0, 'model_name': 'Full', 'mamba2': False, 'reverse': False, 'reverse_start': False, 'last_layer': 'identity', 'test_folder_name': None, 'test_data_loc': 'data/start_2/2000_10_2.pt', 'B': None, 'x_flipped': False}





























































































































  6%|████▏                                                             | 126/2000 [08:22<2:04:34,  3.99s/it]
Traceback (most recent call last):
  File "/exports/eddie/scratch/s2517783/mamba/tsp.py", line 156, in <module>
    tours_train, sumLogProbOfActions = seq2seq_generate_tour(device,model_train,inputs,deterministic=False)
                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/exports/eddie/scratch/s2517783/mamba/model.py", line 260, in seq2seq_generate_tour
    outputs = model(inputs)[:,-1,:]
              ^^^^^^^^^^^^^
  File "/exports/eddie/scratch/s2517783/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/exports/eddie/scratch/s2517783/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/exports/eddie/scratch/s2517783/mamba/model.py", line 230, in forward
    x , residual = layer(x,residual)
                   ^^^^^^^^^^^^^^^^^
  File "/exports/eddie/scratch/s2517783/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/exports/eddie/scratch/s2517783/miniconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/exports/eddie/scratch/s2517783/mamba/mamba_ssm/modules/block.py", line 57, in forward
    hidden_states, residual = layer_norm_fn(
                              ^^^^^^^^^^^^^^
  File "/exports/eddie/scratch/s2517783/mamba/mamba_ssm/ops/triton/layer_norm.py", line 902, in layer_norm_fn
    return LayerNormFn.apply(
           ^^^^^^^^^^^^^^^^^^
  File "/exports/eddie/scratch/s2517783/miniconda3/lib/python3.12/site-packages/torch/autograd/function.py", line 598, in apply
    return super().apply(*args, **kwargs)  # type: ignore[misc]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/exports/eddie/scratch/s2517783/mamba/mamba_ssm/ops/triton/layer_norm.py", line 775, in forward
    y, y1, mean, rstd, residual_out, seeds, dropout_mask, dropout_mask1 = _layer_norm_fwd(
                                                                          ^^^^^^^^^^^^^^^^
  File "/exports/eddie/scratch/s2517783/mamba/mamba_ssm/ops/triton/layer_norm.py", line 369, in _layer_norm_fwd
    _layer_norm_fwd_1pass_kernel[(M,)](
  File "/exports/eddie/scratch/s2517783/miniconda3/lib/python3.12/site-packages/triton/runtime/jit.py", line 167, in <lambda>
    return lambda *args, **kwargs: self.run(grid=grid, warmup=False, *args, **kwargs)
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/exports/eddie/scratch/s2517783/miniconda3/lib/python3.12/site-packages/triton/runtime/autotuner.py", line 156, in run
    ret = self.fn.run(
          ^^^^^^^^^^^^
  File "/exports/eddie/scratch/s2517783/miniconda3/lib/python3.12/site-packages/triton/runtime/autotuner.py", line 305, in run
    return self.fn.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/exports/eddie/scratch/s2517783/miniconda3/lib/python3.12/site-packages/triton/runtime/autotuner.py", line 305, in run
    return self.fn.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/exports/eddie/scratch/s2517783/miniconda3/lib/python3.12/site-packages/triton/runtime/autotuner.py", line 305, in run
    return self.fn.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/exports/eddie/scratch/s2517783/miniconda3/lib/python3.12/site-packages/triton/runtime/jit.py", line 386, in run
    args = [KernelArg(arg_value, param) for (_, arg_value), param in zip(bound_args.arguments.items(), self.params)]
                                                                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt